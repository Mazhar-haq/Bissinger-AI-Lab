<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bissinger's Herald Square Truffle Tracker</title>
    <link rel="stylesheet" href="truffle-tracker.css">
</head>
<body onload="init()">

    <div id="toast" class="toast">Action Complete</div>

    <div class="header">
        <button class="settings-btn" onclick="toggleGuide()">üìñ Help</button>
        <h1>Bissinger's Truffle Tracker</h1>
        <p id="displayDate" style="font-size: 0.8rem; opacity: 0.8;"></p>
    </div>

    <div id="guide" class="card" style="display: none;">
        <div class="guide-section">
            <h3>‚òÄÔ∏è Morning Shift</h3>
            <p style="font-size: 0.75rem; margin-bottom: 5px;">Enter counts in <b>AM</b> column. Click <b>Lock AM</b> when done to prevent accidental changes.</p>
        </div>
        <div class="guide-section">
            <h3>üîÑ Refill Column</h3>
            <p style="font-size: 0.75rem; margin-bottom: 5px;">Use <b>Refill</b> to add truffles brought from the back during the day. This increases the sold count.</p>
        </div>
        <div class="guide-section">
            <h3>üìä Auto-Calculations</h3>
            <p style="font-size: 0.75rem; margin-bottom: 5px;"><b>Sold</b> = (AM ‚àí PM) + Refill<br><b>End</b> = PM count at close</p>
        </div>
        <button onclick="toggleGuide()" style="width: 100%; padding: 8px; background: var(--bissingers-brown); color: var(--bissingers-gold); border: none; border-radius: 4px; cursor: pointer; font-size: 0.7rem;">CLOSE GUIDE</button>
    </div>

    <div class="card">
        <div class="input-grid">
            <div class="input-group">
                <label>Date</label>
                <input type="date" id="trackingDate" onchange="updateDateDisplay(); saveData();">
            </div>
            <div class="input-group">
                <label>Opening MOD</label>
                <select id="openingMod" onchange="saveData()">
                    <option value="">Select...</option>
                    <option>Arin</option><option>Czar</option><option>Faith</option><option>Gully</option><option>Associate</option>
                </select>
            </div>
            <div class="input-group">
                <label>Closing MOD</label>
                <select id="closingMod" onchange="saveData()">
                    <option value="">Select...</option>
                    <option>Arin</option><option>Czar</option><option>Faith</option><option>Gully</option><option>Associate</option>
                </select>
            </div>
        </div>
        <div style="display: flex; gap: 8px; margin-top: 15px;">
            <button id="lockAmBtn" style="flex: 2; padding: 10px; background: var(--bissingers-gold); border: none; font-weight: bold; border-radius: 4px; cursor: pointer;" onclick="lockAM()">Lock AM Counts</button>
            <button style="flex: 1; padding: 10px; background: var(--info); color: white; border: none; font-weight: bold; border-radius: 4px; cursor: pointer;" onclick="openReport()">üìã Report</button>
            <button style="flex: 1; padding: 10px; background: var(--success); color: white; border: none; font-weight: bold; border-radius: 4px; cursor: pointer;" onclick="window.print()">üñ®Ô∏è PDF</button>
        </div>
        <div style="margin-top: 10px;">
            <button style="width: 100%; padding: 8px; background: transparent; color: var(--danger); border: 1px solid var(--danger); font-size: 0.7rem; font-weight: bold; border-radius: 4px; cursor: pointer; text-transform: uppercase;" onclick="confirmReset()">Clear All Today's Data</button>
        </div>
    </div>

    <div class="floor-tabs">
        <button class="tab-btn active" id="btn-f6" onclick="switchFloor('f6')">6th Floor Case</button>
        <button class="tab-btn" id="btn-f1" onclick="switchFloor('f1')">1st Floor Case</button>
    </div>

    <div id="f6-view" class="floor-view active">
        <div class="card" style="padding: 5px;">
            <div class="table-container">
                <table id="f6Table">
                    <thead>
                        <tr>
                            <th style="width: 40%;">Flavor</th>
                            <th>AM</th>
                            <th>Refill</th>
                            <th>PM</th>
                            <th>Sold</th>
                            <th>End</th>
                        </tr>
                    </thead>
                    <tbody id="f6Body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="f1-view" class="floor-view">
        <div class="card" style="padding: 5px;">
            <div class="table-container">
                <table id="f1Table">
                    <thead>
                        <tr>
                            <th style="width: 40%;">Flavor</th>
                            <th>AM</th>
                            <th>Refill</th>
                            <th>PM</th>
                            <th>Sold</th>
                            <th>End</th>
                        </tr>
                    </thead>
                    <tbody id="f1Body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="summary-footer">
        <div class="summary-stats">
            <div class="summary-item">
                <span style="font-size: 0.6rem;">F6 STOCK</span>
                <span class="summary-val" id="total-f6">0</span>
            </div>
            <div class="summary-item">
                <span style="font-size: 0.6rem;">F1 STOCK</span>
                <span class="summary-val" id="total-f1">0</span>
            </div>
            <div class="summary-item">
                <span style="font-size: 0.6rem;">GRAND TOTAL</span>
                <span class="summary-val" id="total-grand" style="color:white; border-bottom: 2px solid var(--bissingers-gold);">0</span>
            </div>
        </div>
        
        <div class="top-sellers-panel">
            <div class="top-sellers-title">üèÜ Top Sellers Today</div>
            <div id="topSellersList" class="top-sellers-grid">
                <div class="seller-badge" style="opacity: 0.5;">Enter PM counts to track...</div>
            </div>
        </div>
    </div>

    <div id="reportModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:3000; justify-content:center; align-items:center;">
        <div style="background:white; padding:25px; border-radius:8px; width:90%; max-width:350px; text-align:center;">
            <h3>Report Generation</h3>
            <button style="width:100%; padding:12px; margin:8px 0; background:var(--info); color:white; border:none; border-radius:4px; font-weight:bold; cursor:pointer;" onclick="generateReport('am')">Copy AM Report</button>
            <button style="width:100%; padding:12px; margin:8px 0; background:var(--bissingers-brown); color:var(--bissingers-gold); border:none; border-radius:4px; font-weight:bold; cursor:pointer;" onclick="generateReport('pm')">Copy PM Report</button>
            <button style="width:100%; padding:10px; margin-top:10px; border:none; background:#eee; cursor:pointer;" onclick="closeReport()">Cancel</button>
        </div>
    </div>

    <script src="tracker-logic.js"></script>
</body>
</html>
